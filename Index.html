<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ArtVandalAI â€” Creative Chaos, Crafted by AI</title>
<style>
  :root {
    --bg-light: #fafafa;
    --bg-dark: #121212;
    --text-light: #222;
    --text-dark: #eee;
    --primary: #ff4081;
    --input-bg-light: #fff;
    --input-bg-dark: #222;
    --btn-bg: var(--primary);
    --btn-hover-bg: #e73370;
  }
  body {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-light);
    color: var(--text-light);
    min-height: 100vh;
    display: flex; flex-direction: column; align-items: center;
    transition: background 0.3s, color 0.3s;
  }
  body.dark {
    background: var(--bg-dark);
    color: var(--text-dark);
  }
  header {
    padding: 1rem;
    text-align: center;
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    font-size: 1.8rem;
  }
  header p {
    margin: 0.3rem 0 1rem 0;
    font-style: italic;
    color: var(--primary);
  }
  main {
    max-width: 800px;
    width: 100%;
    padding: 1rem;
  }
  label {
    display: block;
    margin: 0.6rem 0 0.3rem 0;
    font-weight: 600;
  }
  input[type=text], select, textarea {
    width: 100%;
    padding: 0.5rem;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 6px;
    background: var(--input-bg-light);
    color: inherit;
    box-sizing: border-box;
    transition: background 0.3s, border-color 0.3s;
  }
  body.dark input[type=text], 
  body.dark select, 
  body.dark textarea {
    background: var(--input-bg-dark);
    border-color: #555;
  }
  textarea {
    resize: vertical;
    min-height: 60px;
  }
  button {
    margin-top: 1rem;
    background: var(--btn-bg);
    border: none;
    color: white;
    font-weight: 700;
    font-size: 1.1rem;
    padding: 0.7rem 1.4rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background: var(--btn-hover-bg);
  }
  #statusMessage {
    margin-top: 1rem;
    font-weight: 600;
    min-height: 1.4rem;
    font-style: italic;
  }
  #imagesContainer {
    margin-top: 1.5rem;
    display: grid;
    grid-gap: 1rem;
  }
  /* Responsive grid based on number of images */
  #imagesContainer.grid-1 { grid-template-columns: 1fr; }
  #imagesContainer.grid-2 { grid-template-columns: repeat(2, 1fr); }
  #imagesContainer.grid-3 { grid-template-columns: repeat(3, 1fr); }
  #imagesContainer.grid-4 { grid-template-columns: repeat(2, 1fr); }
  #imagesContainer.grid-5 { grid-template-columns: repeat(3, 1fr); }
  #imagesContainer.grid-6 { grid-template-columns: repeat(3, 1fr); }
  .imageCard {
    background: var(--input-bg-light);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgb(0 0 0 / 0.15);
    display: flex;
    flex-direction: column;
  }
  body.dark .imageCard {
    background: var(--input-bg-dark);
  }
  .imageCard img {
    width: 100%;
    height: auto;
    display: block;
  }
  .imageActions {
    display: flex;
    justify-content: space-between;
    padding: 0.5rem 0.8rem;
    background: rgba(0,0,0,0.05);
  }
  body.dark .imageActions {
    background: rgba(255,255,255,0.05);
  }
  .imageActions button {
    background: var(--primary);
    font-size: 0.85rem;
    padding: 0.3rem 0.7rem;
    border-radius: 4px;
    font-weight: 600;
    transition: background 0.3s;
  }
  .imageActions button:hover {
    background: #e73370;
  }
  #darkToggle {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 1.4rem;
    color: var(--primary);
    transition: color 0.3s;
  }
  #darkToggle:hover {
    color: #e73370;
  }
  footer {
    margin: 2rem 0 1rem 0;
    font-size: 0.8rem;
    color: #999;
    text-align: center;
  }
  @media(max-width: 600px){
    #imagesContainer.grid-3,
    #imagesContainer.grid-5,
    #imagesContainer.grid-6 {
      grid-template-columns: repeat(2, 1fr);
    }
  }
</style>
</head>
<body>
<button id="darkToggle" title="Toggle Dark Mode" aria-label="Toggle Dark Mode">ðŸŒ™</button>

<header>
  <h1>ArtVandalAI</h1>
  <p>Creative Chaos, Crafted by AI</p>
</header>

<main>
  <label for="promptInput">Prompt *</label>
  <textarea id="promptInput" placeholder="Describe your image..." required rows="3"></textarea>

  <label for="negativePromptInput">Negative Prompt (optional)</label>
  <textarea id="negativePromptInput" placeholder="What to exclude..." rows="2"></textarea>

  <label for="imageCount">Number of Images</label>
  <select id="imageCount">
    <option value="1">1</option>
    <option value="2" selected>2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
  </select>

  <label for="styleSelect">Art Style</label>
  <select id="styleSelect">
    <option value="">-- Select style (optional) --</option>
    <option value="anime">Anime</option>
    <option value="photorealistic">Photorealistic</option>
    <option value="watercolor painting">Watercolor Painting</option>
    <option value="cyberpunk">Cyberpunk</option>
    <option value="pencil sketch">Pencil Sketch</option>
  </select>

  <label for="sizeSelect">Image Size / Aspect Ratio</label>
  <select id="sizeSelect">
    <option value="1:1">Square (1:1)</option>
    <option value="4:5">Portrait (4:5)</option>
    <option value="16:9">Landscape (16:9)</option>
  </select>

  <button id="generateBtn">Generate</button>
  <div id="statusMessage" aria-live="polite"></div>

  <div id="imagesContainer" aria-live="polite" role="region" aria-label="Generated images"></div>
</main>

<footer>Â© 2025 ArtVandalAI</footer>

<script>
(() => {
  const promptInput = document.getElementById('promptInput');
  const negativePromptInput = document.getElementById('negativePromptInput');
  const imageCountSelect = document.getElementById('imageCount');
  const styleSelect = document.getElementById('styleSelect');
  const sizeSelect = document.getElementById('sizeSelect');
  const generateBtn = document.getElementById('generateBtn');
  const statusMessage = document.getElementById('statusMessage');
  const imagesContainer = document.getElementById('imagesContainer');
  const darkToggle = document.getElementById('darkToggle');

  // Status messages to rotate
  const statusMessages = [
    "Brewing...", "Digesting...", "Chewing...", "Sketching...", "Rendering...",
    "Cooking...", "Crafting...", "Processing...", "Painting...", "Forming...",
    "Imagining...", "Baking...", "Designing...", "Composing...", "Manifesting..."
  ];

  let statusInterval = null;

  // Dark mode toggle with localStorage
  function applyDarkMode(isDark) {
    if(isDark) document.body.classList.add('dark');
    else document.body.classList.remove('dark');
  }
  function loadDarkMode() {
    const saved = localStorage.getItem('darkMode');
    applyDarkMode(saved === 'true');
  }
  darkToggle.addEventListener('click', () => {
    const isDark = document.body.classList.toggle('dark');
    localStorage.setItem('darkMode', isDark);
  });
  loadDarkMode();

  // Build full prompt text with style and negative prompt
  function buildPrompt() {
    let prompt = promptInput.value.trim();
    if (styleSelect.value) {
      prompt += ', ' + styleSelect.value;
    }
    if (negativePromptInput.value.trim()) {
      prompt += ', negative prompt: ' + negativePromptInput.value.trim();
    }
    return prompt;
  }

  // Generate Pollinations image URL
  function generateImageURL(prompt, size) {
    // Pollinations API doesn't officially support size, but we can add it as text prompt to guide model
    return `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt + ', ' + size + ' aspect ratio')}`;
  }

  // Copy text to clipboard
  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      alert('Prompt copied to clipboard!');
    }, () => {
      alert('Failed to copy prompt.');
    });
  }

  // Download image
  function downloadImage(url, index) {
    fetch(url)
      .then(res => res.blob())
      .then(blob => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `artvandalai_image_${index + 1}.png`;
        document.body.appendChild(a);
        a.click();
        a.remove();
      })
      .catch(() => alert('Failed to download image.'));
  }

  // Rotate status messages while generating
  function startStatusRotation() {
    let i = 0;
    statusMessage.textContent = statusMessages[i];
    statusInterval = setInterval(() => {
      i = (i + 1) % statusMessages.length;
      statusMessage.textContent = statusMessages[i];
    }, 1200);
  }
  function stopStatusRotation() {
    clearInterval(statusInterval);
    statusMessage.textContent = '';
  }

  // Clear images
  function clearImages() {
    imagesContainer.innerHTML = '';
    imagesContainer.className = '';
  }

  // Generate images
  async function generateImages() {
    const count = parseInt(imageCountSelect.value, 10);
    const basePrompt = buildPrompt();
    if (!basePrompt) {
      alert('Please enter a prompt.');
      return;
    }

    clearImages();
    startStatusRotation();
    generateBtn.disabled = true;

    // Let browser paint status message before heavy processing
    await new Promise(res => setTimeout(res, 100));

    imagesContainer.classList.add(`grid-${count}`);

    for (let i = 0; i < count; i++) {
      const url = generateImageURL(basePrompt, sizeSelect.value);

      const card = document.createElement('div');
      card.className = 'imageCard';

      const img = document.createElement('img');
      img.alt = `Generated image ${i + 1} for prompt: ${basePrompt}`;
      img.src = url + `?cb=${Date.now()}_${i}`; // Unique cache-buster per image

      const actions = document.createElement('div');
      actions.className = 'imageActions';

      const dlBtn = document.createElement('button');
      dlBtn.textContent = 'Download';
      dlBtn.addEventListener('click', () => downloadImage(img.src, i));

      const cpBtn = document.createElement('button');
      cpBtn.textContent = 'Copy Prompt';
      cpBtn.title = basePrompt;
      cpBtn.addEventListener('click', () => copyToClipboard(basePrompt));

      actions.appendChild(dlBtn);
      actions.appendChild(cpBtn);

      card.appendChild(img);
      card.appendChild(actions);
      imagesContainer.appendChild(card);

      // Slight delay to stagger requests
      await new Promise(res => setTimeout(res, 500));
    }

    stopStatusRotation();
    generateBtn.disabled = false;
  }

  generateBtn.addEventListener('click', generateImages);

  // Accessibility: allow Enter key to trigger generation from prompt textarea
  promptInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      generateBtn.click();
    }
  });
})();
</script>
</body>
</html>
